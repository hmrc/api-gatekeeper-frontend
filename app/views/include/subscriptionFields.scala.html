@*
 * Copyright 2020 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import views.helper.IdFormatter
@import model.SubscriptionFields._
@import model.{Application, APIVersion}
@import model.Forms.SubscriptionFieldsForm

@(appId: String, version: APIVersion, context: String, subFieldsForm: Form[SubscriptionFieldsForm])(implicit request: Request[Any], messages: Messages)

<div class="accordion__body__row accordion__body__row--no-border">
    <div class="accordion__body__row__left">

        @helper.form(action = routes.ApplicationController.updateSubscriptionFields(appId.toString, context, version.version), 'class -> "fields-subscription") {
        <div class="form-field-group">
            @helper.CSRF.formField
            @helper.repeat(subFieldsForm("fields")) { field =>
            <div class="form-field">
                <label class="label--full-length" for="@{context}-@{version.version}-@{field("description").value.getOrElse("")}">
                <strong class="bold">@{field("description").value.getOrElse("")}</strong>
                <p>@{field("hint").value.getOrElse("")}</p>
                </label>

                @helper.input(field("name"), '_label -> null) { (id, name, value, args) =>
                <input type="hidden" name="@name" id="@id" value="@value">
                }
                @helper.input(field("description"), '_label -> null) { (id, name, value, args) =>
                <input type="hidden" name="@name" id="@id" value="@value">
                }
                @helper.input(field("hint"), '_label -> null) { (id, name, value, args) =>
                <input type="hidden" name="@name" id="@id" value="@value">
                }
                @helper.input(field("type"), '_label -> null) { (id, name, value, args) =>
                <input type="hidden" name="@name" id="@id" value="@value">
                }
                @helper.input(field("value"), '_label -> null) { (id, name, value, args) =>
                <input type="text" name="@name" value="@{field("value").value.getOrElse("")}" class="form-input input--medium" id="@{IdFormatter.identifier(context, version.version)}-@{field("name").value.getOrElse("")}">
                }
            </div>
            }

            <div class="form-field form-field--submit">
                <button id="@{IdFormatter.identifier(context, version.version)}-submit" class="button submit-button" type="submit">Save changes</button>
            </div>
        </div>
        }
    </div>
</div>
